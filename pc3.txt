#include <stdio.h>
#include <stdlib.h>
#include <omp.h>

long fib(int n){
  if(n<2) return n;
  long x,y;
  #pragma omp task shared(x) 
  x = fib(n-1);
  #pragma omp task shared(y)
  y = fib(n-2);
  #pragma omp taskwait
  return x+y;
}

int main(int argc,char **argv){
  int n = argc>1?atoi(argv[1]):10;
  long ans;
  #pragma omp parallel
  { #pragma omp single
    ans = fib(n);
  }
  printf("Fib(%d) = %ld\n", n, ans);
  return 0;
}
